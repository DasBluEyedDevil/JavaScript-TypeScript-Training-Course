{
  "id": "14",
  "title": "Module 14: Deployment & Professional Tools",
  "description": "Deploy your applications to production, use Git for version control, and adopt professional development practices",
  "goal": "Launch your full-stack applications to the internet and work like a professional developer",
  "lessons": [
    {
      "id": "14.1",
      "title": "Version Control with Git (The Time Machine Analogy)",
      "conceptAnalogy": "Imagine writing a book:\n\nWithout version control:\n- Save as: book_final.docx\n- Save as: book_final_v2.docx\n- Save as: book_final_v2_ACTUALLY_FINAL.docx\n- Save as: book_final_v2_ACTUALLY_FINAL_fixed.docx\n- Which one is the real final version?!\n- Want to go back to Tuesday's version? Good luck finding it!\n- Working with co-author? Email files back and forth (nightmare!)\n\nWith Git (version control):\n- One file: book.docx\n- Every save creates a snapshot (commit)\n- Can jump to ANY previous version instantly\n- See exactly what changed and when\n- Multiple authors work simultaneously\n- Automatic merging of changes\n- Complete history preserved forever\n\nGit is like a time machine for your code. It tracks every change, lets you experiment safely, and makes collaboration seamless!",
      "codeExample": "// Git Concepts (Simulated)\n// Git is a command-line tool, not JavaScript, but let's understand the concepts!\n\nconsole.log('=== Git Version Control ===\\n');\n\n// CONCEPT 1: REPOSITORY - Project history\nlet repository = {\n  name: 'my-awesome-app',\n  commits: [],\n  currentBranch: 'main',\n  branches: ['main']\n};\n\nconsole.log('Repository:', repository.name);\n\n// CONCEPT 2: COMMIT - Snapshot of your code\nfunction commit(message, files) {\n  let snapshot = {\n    id: Math.random().toString(36).substr(2, 7),\n    message: message,\n    files: files,\n    timestamp: new Date().toISOString(),\n    author: 'You'\n  };\n  \n  repository.commits.push(snapshot);\n  console.log(`âœ“ Committed: \"${message}\" (${snapshot.id})`);\n  return snapshot;\n}\n\n// CONCEPT 3: BRANCH - Parallel version of code\nfunction createBranch(name) {\n  repository.branches.push(name);\n  console.log(`âœ“ Created branch: ${name}`);\n}\n\nfunction switchBranch(name) {\n  if (repository.branches.includes(name)) {\n    repository.currentBranch = name;\n    console.log(`âœ“ Switched to branch: ${name}`);\n  }\n}\n\n// SIMULATE GIT WORKFLOW\nconsole.log('\\n--- Simulating Git Workflow ---\\n');\n\n// 1. Initial commit\ncommit('Initial commit', ['index.html', 'app.js', 'styles.css']);\n\n// 2. Add feature\ncommit('Add user authentication', ['auth.js', 'login.html']);\n\n// 3. Fix bug\ncommit('Fix login button styling', ['styles.css']);\n\n// 4. Create feature branch\ncreate Branch('feature/dark-mode');\nswitchBranch('feature/dark-mode');\n\n// 5. Work on feature\ncommit('Add dark mode toggle', ['darkMode.js', 'styles.css']);\n\n// 6. Switch back to main\nswitchBranch('main');\n\nconsole.log('\\n--- Repository State ---');\nconsole.log('Total commits:', repository.commits.length);\nconsole.log('Branches:', repository.branches.join(', '));\nconsole.log('Current branch:', repository.currentBranch);\n\nconsole.log('\\n--- Commit History ---');\nrepository.commits.forEach((c, i) => {\n  console.log(`${i + 1}. [${c.id}] ${c.message}`);\n});\n\n// GIT COMMANDS REFERENCE\nconsole.log('\\n=== Essential Git Commands ===\\n');\n\nlet gitCommands = {\n  'git init': 'Create new Git repository',\n  'git clone <url>': 'Download existing repository',\n  'git status': 'See which files changed',\n  'git add <file>': 'Stage file for commit',\n  'git add .': 'Stage all changed files',\n  'git commit -m \"message\"': 'Save snapshot with message',\n  'git log': 'View commit history',\n  'git branch <name>': 'Create new branch',\n  'git checkout <branch>': 'Switch to branch',\n  'git merge <branch>': 'Merge branch into current',\n  'git pull': 'Download latest changes from remote',\n  'git push': 'Upload your commits to remote',\n  'git diff': 'See what changed in files'\n};\n\nfor (let [command, description] of Object.entries(gitCommands)) {\n  console.log(`${command.padEnd(30)} - ${description}`);\n}\n\n// TYPICAL WORKFLOW\nconsole.log('\\n=== Typical Git Workflow ===\\n');\n\nlet workflow = [\n  '1. Make changes to your code',\n  '2. git status               (see what changed)',\n  '3. git add .                (stage all changes)',\n  '4. git commit -m \"Add feature X\"  (save snapshot)',\n  '5. git push                 (upload to GitHub)',\n  '',\n  'Repeat for every feature/fix!'\n];\n\nworkflow.forEach(step => console.log(step));\n\nconsole.log('\\n--- Why Use Git? ---');\nlet benefits = [\n  'âœ“ Never lose code (complete history)',\n  'âœ“ Experiment safely (branches)',\n  'âœ“ Collaborate easily (merge changes)',\n  'âœ“ See who changed what and when',\n  'âœ“ Revert mistakes instantly',\n  'âœ“ Required by all professional teams',\n  'âœ“ Works with GitHub (code hosting)'\n];\n\nbenefits.forEach(b => console.log(b));",
      "syntaxBreakdown": "Git fundamentals:\n\n1. **Setting Up Git**:\n   ```bash\n   # Configure Git (one time)\n   git config --global user.name \"Your Name\"\n   git config --global user.email \"you@example.com\"\n   \n   # Create new repository\n   git init\n   \n   # Or clone existing\n   git clone https://github.com/username/repo.git\n   ```\n\n2. **Basic Workflow**:\n   ```bash\n   # 1. Check status\n   git status\n   \n   # 2. Stage changes\n   git add filename.js      # Single file\n   git add .                # All files\n   \n   # 3. Commit\n   git commit -m \"Add user login feature\"\n   \n   # 4. Push to remote (GitHub)\n   git push\n   ```\n\n3. **Branches**:\n   ```bash\n   # Create and switch to new branch\n   git checkout -b feature/new-feature\n   \n   # Switch between branches\n   git checkout main\n   git checkout feature/new-feature\n   \n   # Merge branch into current\n   git checkout main\n   git merge feature/new-feature\n   \n   # Delete branch\n   git branch -d feature/new-feature\n   ```\n\n4. **Viewing History**:\n   ```bash\n   # See commits\n   git log\n   git log --oneline    # Compact view\n   \n   # See changes\n   git diff             # Unstaged changes\n   git diff --staged    # Staged changes\n   ```\n\n5. **.gitignore** - Files to never commit:\n   ```\n   node_modules/\n   .env\n   .DS_Store\n   dist/\n   build/\n   *.log\n   ```\n\n6. **GitHub Workflow**:\n   ```bash\n   # First time setup\n   git remote add origin https://github.com/username/repo.git\n   git push -u origin main\n   \n   # Regular updates\n   git pull    # Download changes\n   git push    # Upload changes\n   ```\n\n7. **Commit Messages** (best practices):\n   - Start with verb: \"Add\", \"Fix\", \"Update\", \"Remove\"\n   - Be specific: \"Fix login button alignment\"\n   - Not vague: \"Fixed stuff\" or \"Changes\"\n   - Present tense: \"Add feature\" not \"Added feature\"",
      "challenge": {
        "instructions": "Simulate a Git repository:\n\n1. Create a `repo` object with:\n   - commits array\n   - branches array (start with 'main')\n   - currentBranch property\n\n2. Create function `makeCommit(message)` that:\n   - Adds commit to commits array\n   - Returns commit object with: id, message, timestamp\n\n3. Create function `createBranch(name)` that:\n   - Adds branch to branches array\n\n4. Test by making 3 commits and creating 1 branch",
        "starterCode": "// Git repository simulation\nlet repo = {\n  commits: [],\n  branches: ['main'],\n  currentBranch: 'main'\n};\n\nfunction makeCommit(message) {\n  let commit = {\n    id: Math.random().toString(36).substr(2, 7),\n    message: message,\n    timestamp: new Date().toISOString()\n  };\n  repo.commits.push(commit);\n  console.log(`Committed: ${message} (${commit.id})`);\n  return commit;\n}\n\nfunction createBranch(name) {\n  repo.branches.push(name);\n  console.log(`Created branch: ${name}`);\n}\n\n// Test\nmakeCommit('Initial commit');\nmakeCommit('Add homepage');\nmakeCommit('Fix CSS');\ncreateBranch('feature/login');\n\nconsole.log('\\nRepository state:');\nconsole.log('Commits:', repo.commits.length);\nconsole.log('Branches:', repo.branches);",
        "testCases": [
          {
            "description": "Should track commits",
            "input": "let commits = []; commits.push({ id: 1, msg: 'Test' }); commits.length",
            "expectedOutput": "1"
          }
        ],
        "hint": "Use array push() to add commits and branches."
      },
      "solution": "// Complete Git simulation\nlet repo = {\n  commits: [],\n  branches: ['main'],\n  currentBranch: 'main',\n  files: {}\n};\n\nfunction makeCommit(message, files = []) {\n  let commit = {\n    id: Math.random().toString(36).substr(2, 7),\n    message: message,\n    branch: repo.currentBranch,\n    files: files,\n    timestamp: new Date().toISOString(),\n    author: 'Developer'\n  };\n  \n  repo.commits.push(commit);\n  console.log(`âœ“ [${commit.id}] ${message}`);\n  return commit;\n}\n\nfunction createBranch(name) {\n  if (repo.branches.includes(name)) {\n    console.log(`âœ— Branch ${name} already exists`);\n    return false;\n  }\n  repo.branches.push(name);\n  console.log(`âœ“ Created branch: ${name}`);\n  return true;\n}\n\nfunction switchBranch(name) {\n  if (!repo.branches.includes(name)) {\n    console.log(`âœ— Branch ${name} does not exist`);\n    return false;\n  }\n  repo.currentBranch = name;\n  console.log(`âœ“ Switched to branch: ${name}`);\n  return true;\n}\n\nfunction showLog() {\n  console.log('\\n=== Commit History ===');\n  repo.commits.forEach((c, i) => {\n    console.log(`${i + 1}. [${c.id}] (${c.branch}) ${c.message}`);\n    if (c.files.length > 0) {\n      console.log(`   Files: ${c.files.join(', ')}`);\n    }\n  });\n}\n\nfunction showStatus() {\n  console.log('\\n=== Repository Status ===');\n  console.log(`Current branch: ${repo.currentBranch}`);\n  console.log(`Total branches: ${repo.branches.join(', ')}`);\n  console.log(`Total commits: ${repo.commits.length}`);\n}\n\n// Simulate development workflow\nconsole.log('=== Git Workflow Simulation ===\\n');\n\nmakeCommit('Initial commit', ['README.md', 'package.json']);\nmakeCommit('Add Express server', ['server.js']);\nmakeCommit('Add database connection', ['db.js', 'prisma/schema.prisma']);\n\ncreateBranch('feature/authentication');\nswitchBranch('feature/authentication');\n\nmakeCommit('Add login route', ['routes/auth.js']);\nmakeCommit('Add JWT middleware', ['middleware/auth.js']);\n\nswitchBranch('main');\nmakeCommit('Update README', ['README.md']);\n\nshowLog();\nshowStatus();\n\nconsole.log('\\n--- Git Best Practices ---');\nlet practices = [\n  'âœ“ Commit often (small, focused commits)',\n  'âœ“ Write clear commit messages',\n  'âœ“ Use branches for features',\n  'âœ“ Never commit secrets (.env files)',\n  'âœ“ Pull before you push',\n  'âœ“ Review changes before committing (git diff)',\n  'âœ“ Use .gitignore for node_modules, etc.'\n];\npractices.forEach(p => console.log(p));",
      "commonStickingPoints": "Common Git mistakes:\n\n1. **Forgetting to commit**:\n   ```bash\n   # Made lots of changes, forgot to commit\n   # Now have 50 files changed\n   # Hard to write one commit message!\n   \n   # Better: Commit after each feature\n   git add .\n   git commit -m \"Add user login\"\n   # Then continue coding\n   ```\n\n2. **Committing secrets**:\n   ```bash\n   # NEVER commit .env files!\n   # Add to .gitignore:\n   .env\n   .env.local\n   config/secrets.js\n   ```\n\n3. **Not using .gitignore**:\n   ```bash\n   # Don't commit node_modules!\n   # Create .gitignore file:\n   node_modules/\n   .DS_Store\n   dist/\n   *.log\n   ```\n\n4. **Merge conflicts** (scary but normal!):\n   ```\n   <<<<<<< HEAD\n   const API_URL = 'http://localhost:3000';\n   =======\n   const API_URL = 'https://api.production.com';\n   >>>>>>> feature-branch\n   ```\n   - Choose which version to keep\n   - Delete conflict markers (<<<<, ====, >>>>)\n   - Commit the resolved file\n\n5. **Wrong branch**:\n   ```bash\n   # Check current branch BEFORE committing!\n   git branch        # Shows all branches\n   git status        # Shows current branch\n   \n   # If on wrong branch:\n   git stash         # Save changes temporarily\n   git checkout correct-branch\n   git stash pop     # Apply changes here\n   ```\n\n6. **Push without pull**:\n   ```bash\n   # Error: Updates were rejected\n   # Someone else pushed while you were working\n   \n   # Fix:\n   git pull          # Get their changes\n   # Resolve conflicts if any\n   git push          # Now it works\n   ```\n\n7. **Vague commit messages**:\n   ```bash\n   # Bad:\n   git commit -m \"fixes\"\n   git commit -m \"stuff\"\n   git commit -m \"asdf\"\n   \n   # Good:\n   git commit -m \"Fix login button alignment on mobile\"\n   git commit -m \"Add password reset functionality\"\n   git commit -m \"Update dependencies to latest versions\"\n   ```"
    },
    {
      "id": "14.2",
      "title": "Deploying Express Backend to Render (The Restaurant Going Live Analogy)",
      "conceptAnalogy": "Imagine opening a restaurant:\n\nDevelopment (your kitchen at home):\n- Cook and test recipes\n- Only you and friends eat the food\n- localhost:3000 (your home address)\n- Turn off stove â†’ restaurant closes\n\nProduction (real restaurant):\n- Open to the public!\n- Anyone can visit and order\n- https://my-restaurant.com (real address)\n- Stays open 24/7 (even when you sleep)\n- Professional kitchen staff (hosting servers)\n\nDeploying your Express API is the same:\n- Move from localhost to real internet\n- Get a public URL (like render.com/yourapp)\n- Runs on powerful servers 24/7\n- Anyone can make requests to your API!\n\nPopular platforms: Render (free!), Railway, Heroku",
      "codeExample": "// Deploying Express API - Concepts\n\nconsole.log('=== Express API Deployment ===\\n');\n\n// CONCEPT: Environment-aware server\nconst PORT = process.env.PORT || 3000;  // Use hosting platform's port\nconst NODE_ENV = process.env.NODE_ENV || 'development';\n\nconsole.log('Environment:', NODE_ENV);\nconsole.log('Port:', PORT);\n\n// Simulating Express app ready for deployment\nconst app = {\n  routes: [\n    { method: 'GET', path: '/api/users', handler: 'getUsers' },\n    { method: 'POST', path: '/api/users', handler: 'createUser' },\n    { method: 'GET', path: '/health', handler: 'healthCheck' }\n  ],\n  \n  config: {\n    cors: true,\n    port: PORT,\n    database: process.env.DATABASE_URL,\n    env: NODE_ENV\n  },\n  \n  listen(port) {\n    console.log(`\\n[Server] Listening on port ${port}`);\n    console.log(`[Server] Environment: ${this.config.env}`);\n    console.log(`[Server] CORS enabled: ${this.config.cors}`);\n    \n    if (this.config.env === 'production') {\n      console.log('\\n[Production Mode]');\n      console.log('  - Using DATABASE_URL from environment');\n      console.log('  - Detailed errors hidden from clients');\n      console.log('  - Compression enabled');\n      console.log('  - Security headers added');\n    } else {\n      console.log('\\n[Development Mode]');\n      console.log('  - Using local database');\n      console.log('  - Full error stack traces shown');\n      console.log('  - Hot reload enabled');\n    }\n  }\n};\n\napp.listen(PORT);\n\n// DEPLOYMENT STEPS SIMULATION\nconsole.log('\\n\\n=== Deployment Process ===\\n');\n\nconst deploymentSteps = [\n  {\n    step: 1,\n    title: 'Prepare Your Code',\n    tasks: [\n      'Add \"start\" script to package.json',\n      'Use environment variables (process.env)',\n      'Add .env to .gitignore',\n      'Commit and push to GitHub'\n    ]\n  },\n  {\n    step: 2,\n    title: 'Create Render Account',\n    tasks: [\n      'Go to render.com',\n      'Sign up with GitHub',\n      'Click \"New +\" â†’ \"Web Service\"'\n    ]\n  },\n  {\n    step: 3,\n    title: 'Configure Service',\n    tasks: [\n      'Connect your GitHub repo',\n      'Name: my-api',\n      'Build Command: npm install',\n      'Start Command: npm start',\n      'Select Free plan'\n    ]\n  },\n  {\n    step: 4,\n    title: 'Add Environment Variables',\n    tasks: [\n      'Click \"Environment\"',\n      'Add DATABASE_URL',\n      'Add JWT_SECRET',\n      'Add other secrets from .env'\n    ]\n  },\n  {\n    step: 5,\n    title: 'Deploy!',\n    tasks: [\n      'Click \"Create Web Service\"',\n      'Wait for build (~2 minutes)',\n      'Get your URL: https://my-api.onrender.com',\n      'Test: https://my-api.onrender.com/health'\n    ]\n  }\n];\n\ndeploymentSteps.forEach(({ step, title, tasks }) => {\n  console.log(`Step ${step}: ${title}`);\n  tasks.forEach(task => console.log(`  - ${task}`));\n  console.log('');\n});\n\n// PACKAGE.JSON FOR DEPLOYMENT\nconsole.log('=== package.json Configuration ===\\n');\n\nconst packageJson = {\n  name: 'my-express-api',\n  version: '1.0.0',\n  scripts: {\n    start: 'node server.js',  // Production start command\n    dev: 'nodemon server.js',  // Development with auto-reload\n    build: 'echo \"No build needed for Express\"'\n  },\n  engines: {\n    node: '>=18.0.0'  // Specify Node version\n  },\n  dependencies: {\n    express: '^4.18.0',\n    cors: '^2.8.5',\n    dotenv: '^16.0.0'\n  }\n};\n\nconsole.log(JSON.stringify(packageJson, null, 2));\n\n// HEALTH CHECK ENDPOINT (important!)\nconsole.log('\\n\\n=== Health Check Endpoint ===\\n');\n\nconsole.log('// Add this to your server:');\nconsole.log(\"app.get('/health', (req, res) => {\");\nconsole.log(\"  res.json({\");\nconsole.log(\"    status: 'ok',\");\nconsole.log(\"    timestamp: new Date(),\");\nconsole.log(\"    uptime: process.uptime()\");\nconsole.log(\"  });\");\nconsole.log(\"});\\n\");\n\nconsole.log('Why? Hosting platforms ping /health to check if app is running!');\n\n// TESTING DEPLOYMENT\nconsole.log('\\n\\n=== Testing Your Deployed API ===\\n');\n\nconst tests = [\n  {\n    test: 'Health Check',\n    command: 'curl https://my-api.onrender.com/health',\n    expected: '{ status: \"ok\" }'\n  },\n  {\n    test: 'GET Request',\n    command: 'curl https://my-api.onrender.com/api/users',\n    expected: '[{ id: 1, name: \"Alice\" }, ...]'\n  },\n  {\n    test: 'POST Request',\n    command: 'curl -X POST https://my-api.onrender.com/api/users -d {\"name\":\"Bob\"}',\n    expected: '{ id: 2, name: \"Bob\" }'\n  }\n];\n\ntests.forEach(({ test, command, expected }) => {\n  console.log(`${test}:`);\n  console.log(`  $ ${command}`);\n  console.log(`  Expected: ${expected}\\n`);\n});",
      "syntaxBreakdown": "Express deployment checklist:\n\n1. **Environment Variables** (CRITICAL!):\n   ```javascript\n   // server.js\n   import 'dotenv/config';  // Load .env file\n   \n   const PORT = process.env.PORT || 3000;\n   const DATABASE_URL = process.env.DATABASE_URL;\n   const JWT_SECRET = process.env.JWT_SECRET;\n   \n   // NEVER hardcode secrets!\n   // WRONG: const secret = 'my-secret-key';\n   // RIGHT: const secret = process.env.JWT_SECRET;\n   ```\n\n2. **package.json Scripts**:\n   ```json\n   {\n     \"scripts\": {\n       \"start\": \"node server.js\",\n       \"dev\": \"nodemon server.js\"\n     },\n     \"engines\": {\n       \"node\": \">=18.0.0\"\n     }\n   }\n   ```\n\n3. **Server Listen** (use process.env.PORT):\n   ```javascript\n   const PORT = process.env.PORT || 3000;\n   \n   app.listen(PORT, () => {\n     console.log(`Server running on port ${PORT}`);\n   });\n   ```\n\n4. **CORS Configuration** (allow frontend):\n   ```javascript\n   import cors from 'cors';\n   \n   const allowedOrigins = [\n     'https://my-frontend.vercel.app',\n     'http://localhost:5173'  // For local dev\n   ];\n   \n   app.use(cors({\n     origin: allowedOrigins,\n     credentials: true\n   }));\n   ```\n\n5. **Health Check Endpoint**:\n   ```javascript\n   app.get('/health', (req, res) => {\n     res.json({ status: 'ok', timestamp: new Date() });\n   });\n   ```\n\n6. **.gitignore** (don't commit secrets!):\n   ```\n   node_modules/\n   .env\n   .env.local\n   .env.production\n   dist/\n   *.log\n   ```\n\n7. **Database Connection** (production-ready):\n   ```javascript\n   import { PrismaClient } from '@prisma/client';\n   \n   const prisma = new PrismaClient({\n     datasources: {\n       db: {\n         url: process.env.DATABASE_URL  // From Render env vars\n       }\n     }\n   });\n   ```\n\n8. **Error Handling** (hide details in production):\n   ```javascript\n   app.use((err, req, res, next) => {\n     console.error(err.stack);\n     \n     if (process.env.NODE_ENV === 'production') {\n       res.status(500).json({ error: 'Internal server error' });\n     } else {\n       res.status(500).json({ error: err.message, stack: err.stack });\n     }\n   });\n   ```",
      "challenge": {
        "instructions": "Prepare an Express server for deployment:\n\n1. Create a `server` object that:\n   - Uses process.env.PORT with fallback to 3000\n   - Has a /health route\n   - Logs startup info\n   - Shows different behavior for production vs development\n\n2. Simulate starting the server in both environments",
        "starterCode": "// Express server ready for deployment\n\nconst server = {\n  port: process.env.PORT || 3000,\n  env: process.env.NODE_ENV || 'development',\n  \n  routes: {\n    '/health': function() {\n      return { status: 'ok', timestamp: new Date() };\n    },\n    '/api/users': function() {\n      return [{ id: 1, name: 'Alice' }];\n    }\n  },\n  \n  start() {\n    console.log(`\\n[Server] Starting...`);\n    console.log(`[Server] Environment: ${this.env}`);\n    console.log(`[Server] Port: ${this.port}`);\n    \n    if (this.env === 'production') {\n      console.log('[Server] Running in PRODUCTION mode');\n      console.log('  - Detailed errors hidden');\n      console.log('  - Using production database');\n    } else {\n      console.log('[Server] Running in DEVELOPMENT mode');\n      console.log('  - Full error traces enabled');\n      console.log('  - Using local database');\n    }\n    \n    console.log(`\\nâœ“ Server ready on port ${this.port}`);\n    console.log(`\\nAvailable routes:`);\n    Object.keys(this.routes).forEach(route => {\n      console.log(`  - ${route}`);\n    });\n  }\n};\n\n// Test\nserver.start();\n\n// Simulate health check\nconsole.log('\\n[Test] GET /health');\nconsole.log('Response:', server.routes['/health']());",
        "testCases": [
          {
            "description": "Should use PORT from environment",
            "input": "process.env.PORT = 8080; process.env.PORT || 3000",
            "expectedOutput": "8080"
          }
        ],
        "hint": "Use process.env.PORT and process.env.NODE_ENV"
      },
      "solution": "// Complete production-ready Express server\n\nconst server = {\n  port: process.env.PORT || 3000,\n  env: process.env.NODE_ENV || 'development',\n  databaseUrl: process.env.DATABASE_URL || 'postgres://localhost/mydb',\n  jwtSecret: process.env.JWT_SECRET || 'dev-secret',\n  \n  routes: {\n    '/health': function() {\n      return {\n        status: 'ok',\n        timestamp: new Date(),\n        uptime: process.uptime(),\n        environment: server.env\n      };\n    },\n    '/api/users': function() {\n      return [\n        { id: 1, name: 'Alice', email: 'alice@example.com' },\n        { id: 2, name: 'Bob', email: 'bob@example.com' }\n      ];\n    },\n    '/api/status': function() {\n      return {\n        server: 'Express API',\n        version: '1.0.0',\n        environment: server.env,\n        database: server.databaseUrl ? 'Connected' : 'Disconnected'\n      };\n    }\n  },\n  \n  middleware: {\n    cors: function() {\n      console.log('[Middleware] CORS enabled');\n      console.log('  Allowed origins: https://my-app.vercel.app, http://localhost:5173');\n    },\n    \n    compression: function() {\n      if (server.env === 'production') {\n        console.log('[Middleware] Compression enabled (gzip)');\n      }\n    },\n    \n    security: function() {\n      if (server.env === 'production') {\n        console.log('[Middleware] Security headers added:');\n        console.log('  - helmet (security headers)');\n        console.log('  - rate limiting');\n        console.log('  - XSS protection');\n      }\n    }\n  },\n  \n  start() {\n    console.log('â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”');\n    console.log('â”‚       Express Server Starting       â”‚');\n    console.log('â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\\n');\n    \n    console.log(`Environment: ${this.env}`);\n    console.log(`Port: ${this.port}`);\n    console.log(`Database: ${this.databaseUrl}\\n`);\n    \n    // Load middleware\n    console.log('Loading middleware:');\n    this.middleware.cors();\n    this.middleware.compression();\n    this.middleware.security();\n    \n    console.log('\\n' + 'â”€'.repeat(39));\n    \n    if (this.env === 'production') {\n      console.log('\\nðŸš€ PRODUCTION MODE');\n      console.log('  âœ“ Using production database');\n      console.log('  âœ“ Errors hidden from clients');\n      console.log('  âœ“ Compression enabled');\n      console.log('  âœ“ Security headers active');\n      console.log('  âœ“ Rate limiting enabled');\n    } else {\n      console.log('\\nðŸ”§ DEVELOPMENT MODE');\n      console.log('  âš  Using local database');\n      console.log('  âš  Full error stack traces');\n      console.log('  âš  No compression');\n      console.log('  âš  Hot reload enabled');\n    }\n    \n    console.log('\\n' + 'â”€'.repeat(39));\n    console.log(`\\nâœ“ Server ready at http://localhost:${this.port}`);\n    \n    if (this.env === 'production') {\n      console.log(`âœ“ Public URL: https://my-api.onrender.com`);\n    }\n    \n    console.log('\\nAvailable Endpoints:');\n    Object.keys(this.routes).forEach(route => {\n      console.log(`  - ${route}`);\n    });\n    \n    console.log('\\n' + 'â•'.repeat(39) + '\\n');\n  },\n  \n  handleRequest(path) {\n    console.log(`\\n[Request] GET ${path}`);\n    \n    if (this.routes[path]) {\n      const response = this.routes[path]();\n      console.log('[Response] 200 OK');\n      console.log(JSON.stringify(response, null, 2));\n      return response;\n    } else {\n      console.log('[Response] 404 Not Found');\n      return { error: 'Route not found' };\n    }\n  }\n};\n\n// Simulate deployment\nconsole.log('=== Simulating Deployment ===\\n');\n\n// Development\nconsole.log('1. LOCAL DEVELOPMENT:\\n');\nprocess.env.NODE_ENV = 'development';\nserver.start();\n\nserver.handleRequest('/health');\nserver.handleRequest('/api/users');\n\n// Production\nconsole.log('\\n\\n2. PRODUCTION DEPLOYMENT:\\n');\nprocess.env.NODE_ENV = 'production';\nprocess.env.PORT = 10000;\nprocess.env.DATABASE_URL = 'postgres://render.com/prod-db';\nserver.port = process.env.PORT;\nserver.env = process.env.NODE_ENV;\nserver.databaseUrl = process.env.DATABASE_URL;\n\nserver.start();\n\nserver.handleRequest('/health');\nserver.handleRequest('/api/status');\n\nconsole.log('\\n=== Deployment Checklist ===\\n');\n\nconst checklist = [\n  'âœ“ Set NODE_ENV=production',\n  'âœ“ Use process.env.PORT',\n  'âœ“ Add health check endpoint',\n  'âœ“ Configure CORS for frontend URL',\n  'âœ“ Add environment variables in Render',\n  'âœ“ Never commit .env files',\n  'âœ“ Add \"start\" script to package.json',\n  'âœ“ Test deployed API with curl/Postman'\n];\n\nchecklist.forEach(item => console.log(item));",
      "commonStickingPoints": "Common deployment mistakes:\n\n1. **Hardcoded PORT** (will crash!):\n   ```javascript\n   // WRONG! Render assigns random port\n   app.listen(3000);  // âœ— Will fail on Render\n   \n   // CORRECT!\n   const PORT = process.env.PORT || 3000;\n   app.listen(PORT);  // âœ“ Works everywhere\n   ```\n\n2. **Committed .env file** (security risk!):\n   ```bash\n   # .gitignore MUST include:\n   .env\n   .env.local\n   .env.production\n   \n   # Check if accidentally committed:\n   git ls-files | grep .env  # Should be empty!\n   ```\n\n3. **Missing start script**:\n   ```json\n   // WRONG! (package.json)\n   {\n     \"scripts\": {\n       \"dev\": \"nodemon server.js\"\n       // No \"start\" script!\n     }\n   }\n   \n   // CORRECT!\n   {\n     \"scripts\": {\n       \"start\": \"node server.js\",\n       \"dev\": \"nodemon server.js\"\n     }\n   }\n   ```\n\n4. **CORS not configured for production frontend**:\n   ```javascript\n   // WRONG! Blocks your frontend\n   app.use(cors({\n     origin: 'http://localhost:5173'  // Only allows local!\n   }));\n   \n   // CORRECT!\n   const allowedOrigins = [\n     'https://my-app.vercel.app',  // Production frontend\n     'http://localhost:5173'       // Local development\n   ];\n   \n   app.use(cors({\n     origin: (origin, callback) => {\n       if (!origin || allowedOrigins.includes(origin)) {\n         callback(null, true);\n       } else {\n         callback(new Error('Not allowed by CORS'));\n       }\n     }\n   }));\n   ```\n\n5. **Database URL not from environment**:\n   ```javascript\n   // WRONG! Won't work in production\n   const db = 'postgresql://localhost/mydb';\n   \n   // CORRECT!\n   const db = process.env.DATABASE_URL || 'postgresql://localhost/mydb';\n   ```\n\n6. **Missing health check** (Render needs this!):\n   ```javascript\n   // Add this route:\n   app.get('/health', (req, res) => {\n     res.json({ status: 'ok' });\n   });\n   \n   // Render pings this to check if server is alive\n   ```\n\n7. **Exposing secrets in errors**:\n   ```javascript\n   // WRONG! Leaks sensitive info\n   app.use((err, req, res, next) => {\n     res.status(500).json({ error: err.stack });  // Shows DB passwords!\n   });\n   \n   // CORRECT!\n   app.use((err, req, res, next) => {\n     console.error(err.stack);  // Log server-side only\n     \n     if (process.env.NODE_ENV === 'production') {\n       res.status(500).json({ error: 'Internal server error' });\n     } else {\n       res.status(500).json({ error: err.message });\n     }\n   });\n   ```"
    }
  ]
}
